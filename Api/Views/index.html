<html>
	<head>
		<title>Temperatures</title>
		<link rel="stylesheet" type="text/css" href="@Path['~/content/css/style.css'];" />
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="@Path['~/content/amcharts/amcharts.js'];" type="text/javascript"></script> 
		<script type="text/javascript">
			
      var lineChartData2 = [
        { date: calcTime('2018-05-21', 2), temp1: 21, temp2: 23 },
        { date: calcTime('2018-05-22', 2), temp1: 21, temp2: 23 },
        { date: calcTime('2018-05-23', 2), temp1: 21, temp2: 23 },
        { date: calcTime('2018-05-24', 2), temp1: 21, temp2: 23 }
      ];
      var lineChartData = [
      @Each.Model
      {
        date : new Date('@Current.Timestamp'),
        temp1: '@Current.Inside'.replace(',', '.'),
        temp2: '@Current.Outside'.replace(',', '.')
      },
      @EndEach
      ];
			function calcTime(unixTime, offset) {

				// create Date object for current location
				d = new Date(unixTime);

				// convert to msec
				// add local time zone offset
				// get UTC time in msec
				utc = d.getTime() + (d.getTimezoneOffset() * 60000);

				// create new Date object for different city
				// using supplied offset
				nd = new Date(utc + (3600000*offset));
				return nd;

			}
			
			function formatLabel(value, valueString, axis){
				// let's say we dont' want minus sign next to negative numbers
				if(value < 0)
				{
					valueString = valueString.substr(1);
				}
				
				// and we also want a letter C to be added next to all labels (you can do it with unit, but anyway)
				valueString = valueString + "° C";
				return valueString;
			}
		
			AmCharts.ready(function () {
                var chart = new AmCharts.AmSerialChart();
                chart.dataProvider = lineChartData;
                chart.pathToImages = "@Path['~/content/amcharts/images/'];";
                chart.categoryField = "date";
				chart.balloon.bulletSize = 5;

                // sometimes we need to set margins manually
                // autoMargins should be set to false in order chart to use custom margin values
                chart.marginLeft = 0;
                chart.marginBottom = 0;
                chart.marginTop = 0;

                // AXES
                // category                
                var categoryAxis = chart.categoryAxis;
                categoryAxis.parseDates = true; // as our data is date-based, we set parseDates to true
                categoryAxis.minPeriod = "ss"; // our data is daily, so we set minPeriod to DD
                categoryAxis.inside = true;
                categoryAxis.gridAlpha = 0;
                categoryAxis.tickLength = 0;
                categoryAxis.axisAlpha = 0;

                // value
                var valueAxis = new AmCharts.ValueAxis();
				valueAxis.dashLength = 1;
                valueAxis.axisAlpha = 0;
				//set label function which will format values
				valueAxis.labelFunction = formatLabel;
				
                chart.addValueAxis(valueAxis);

                // GRAPH
                var graph = new AmCharts.AmGraph();
                graph.type = "line";
                graph.valueField = "temp1";
                graph.lineColor = "#5fb503";
                graph.negativeLineColor = "#efcc26";
				//graph.fillAlphas = 0.3; // setting fillAlphas to > 0 value makes it area graph
                graph.bulletSize = 3; // bullet image should be a rectangle (width = height)
                chart.addGraph(graph);

				var graph = new AmCharts.AmGraph();
                graph.type = "line";
                graph.valueField = "temp2";
                graph.lineColor = "#F2304D";
                graph.negativeLineColor = "#3053F2";
                //graph.fillAlphas = 0.3; // setting fillAlphas to > 0 value makes it area graph
				graph.bulletSize = 3; // bullet image should be a rectangle (width = height)
                chart.addGraph(graph);

				// CURSOR
				var chartCursor = new AmCharts.ChartCursor();
				chartCursor.cursorPosition = "mouse";
				chartCursor.categoryBalloonDateFormat = "JJ:NN, DD MMMM";
				chart.addChartCursor(chartCursor);

                // WRITE
                chart.write("chartdiv");
            });
		</script>

	</head>
	<body>
		<div class="content">
			<div class="thermometers">
				<div class="label">Sensor Interior</div><div class="label">Sensor Exterior</div>
				<div class="de">
					<div class="den">
					  <div class="dene">
						<div class="denem">
						  <div class="deneme">
							  20<span>.5</span><strong>&deg;</strong>
						  </div>
						</div>
					  </div>
					</div>
				</div>
				<div class="de">
					<div class="den">
					  <div class="dene">
						<div class="denem">
						  <div class="deneme">
							  24<span>.3</span><strong>&deg;</strong>
						  </div>
						</div>
					  </div>
					</div>
				</div>
			</div>
			<div id="chartdiv" style="width:100%; height:280px;"></div>
		</div>
	</body>
</html>
